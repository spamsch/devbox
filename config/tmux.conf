# =============================================================================
# tmux Configuration
# =============================================================================
#
# Sensible defaults for development work with tmux.
# This configuration focuses on usability and compatibility.
#
# Quick Reference:
#   Prefix key: Ctrl+b (default)
#   Split horizontal: Ctrl+b |
#   Split vertical: Ctrl+b -
#   Navigate panes: Ctrl+b h/j/k/l (vim-style)
#   New window: Ctrl+b c
#   Next window: Ctrl+b n
#   Previous window: Ctrl+b p
#   Reload config: Ctrl+b r
#
# =============================================================================

# -----------------------------------------------------------------------------
# Terminal Settings
# -----------------------------------------------------------------------------
# Enable 256 colors and true color support for modern terminals.
# This ensures vim, syntax highlighting, and other tools display correctly.
# -----------------------------------------------------------------------------
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# -----------------------------------------------------------------------------
# Mouse Support
# -----------------------------------------------------------------------------
# Enable mouse for scrolling, selecting panes, and resizing.
# This makes tmux much more accessible for new users.
# -----------------------------------------------------------------------------
set -g mouse on

# -----------------------------------------------------------------------------
# History
# -----------------------------------------------------------------------------
# Increase scrollback buffer size for more history.
# Default is 2000; we set it much higher for development work.
# -----------------------------------------------------------------------------
set -g history-limit 50000

# -----------------------------------------------------------------------------
# Indexing
# -----------------------------------------------------------------------------
# Start window and pane numbering at 1 instead of 0.
# This is more intuitive as the keys 1-9 are easier to reach than 0.
# -----------------------------------------------------------------------------
set -g base-index 1
setw -g pane-base-index 1

# Automatically renumber windows when one is closed
set -g renumber-windows on

# -----------------------------------------------------------------------------
# Pane Splitting
# -----------------------------------------------------------------------------
# Use | and - for splitting panes (more intuitive than " and %)
# Keep the current directory when splitting.
# -----------------------------------------------------------------------------
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Remove default split bindings (optional, commented out to keep defaults too)
# unbind '"'
# unbind %

# -----------------------------------------------------------------------------
# Pane Navigation (Vim-Style)
# -----------------------------------------------------------------------------
# Use h/j/k/l for navigating between panes (like vim movement keys)
# -----------------------------------------------------------------------------
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# -----------------------------------------------------------------------------
# Pane Resizing
# -----------------------------------------------------------------------------
# Use H/J/K/L (uppercase) for resizing panes
# -----------------------------------------------------------------------------
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# -----------------------------------------------------------------------------
# Window Navigation
# -----------------------------------------------------------------------------
# Quick window switching with Alt+number (no prefix needed)
# -----------------------------------------------------------------------------
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5

# -----------------------------------------------------------------------------
# Configuration Reload
# -----------------------------------------------------------------------------
# Press Ctrl+b r to reload this configuration file
# -----------------------------------------------------------------------------
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# -----------------------------------------------------------------------------
# Status Bar
# -----------------------------------------------------------------------------
# Minimal status bar that doesn't distract from the work.
# Shows session name on the left, time on the right.
# -----------------------------------------------------------------------------
set -g status-style bg=default,fg=white
set -g status-left "#[fg=green][#S] "
set -g status-left-length 20
set -g status-right "#[fg=cyan]%H:%M"
set -g status-right-length 10

# Window status styling
setw -g window-status-current-style fg=cyan,bold
setw -g window-status-style fg=white

# -----------------------------------------------------------------------------
# Vim Compatibility
# -----------------------------------------------------------------------------
# Reduce escape time so vim mode switching is faster.
# Enable focus events so vim can detect when it gains/loses focus.
# -----------------------------------------------------------------------------
set -sg escape-time 10
set -g focus-events on

# -----------------------------------------------------------------------------
# Copy Mode
# -----------------------------------------------------------------------------
# Use vi-style key bindings in copy mode
# -----------------------------------------------------------------------------
setw -g mode-keys vi

# Vim-style copy/paste bindings
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# -----------------------------------------------------------------------------
# Miscellaneous
# -----------------------------------------------------------------------------
# Don't rename windows automatically based on running command
set -g allow-rename off

# Display messages for longer
set -g display-time 2000

# -----------------------------------------------------------------------------
# Default Layout
# -----------------------------------------------------------------------------
# Create a default layout with 3 panes:
#   - One large pane on the left (for main editor/opencode)
#   - Two smaller panes stacked on the right (for terminals/logs)
#
# Layout:
#   ┌────────────┬────────────┐
#   │            │   pane 2   │
#   │   pane 1   ├────────────┤
#   │   (main)   │   pane 3   │
#   └────────────┴────────────┘
#
# Use Ctrl+b D to create this layout in any session
# -----------------------------------------------------------------------------
bind D source-file ~/.tmux/dev-layout.conf
